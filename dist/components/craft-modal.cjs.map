{"version":3,"sources":["../../src/components/craft-modal.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport { createPortal } from \"react-dom\";\n\nimport { cn } from \"@/utils/cn\";\nimport type { ThemeName } from \"@/theme/theme-context\";\n\nconst FOCUSABLE_SELECTORS = [\n  \"a[href]\",\n  \"button:not([disabled])\",\n  \"textarea:not([disabled])\",\n  \"input:not([disabled])\",\n  \"select:not([disabled])\",\n  \"[tabindex]:not([tabindex='-1'])\",\n].join(\",\");\n\nfunction useFocusTrap(active: boolean) {\n  const ref = React.useRef<HTMLDivElement | null>(null);\n\n  React.useEffect(() => {\n    if (!active || !ref.current) return;\n    const root = ref.current;\n    const getFocusable = () =>\n      Array.from(root.querySelectorAll<HTMLElement>(FOCUSABLE_SELECTORS));\n\n    const focusables = getFocusable();\n    if (focusables.length) {\n      focusables[0].focus();\n    } else {\n      root.focus();\n    }\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key !== \"Tab\") return;\n      const items = getFocusable();\n      if (!items.length) return;\n      const first = items[0];\n      const last = items[items.length - 1];\n      const activeEl = document.activeElement as HTMLElement | null;\n\n      if (event.shiftKey && activeEl === first) {\n        event.preventDefault();\n        last.focus();\n      } else if (!event.shiftKey && activeEl === last) {\n        event.preventDefault();\n        first.focus();\n      }\n    };\n\n    root.addEventListener(\"keydown\", handleKeyDown);\n    return () => root.removeEventListener(\"keydown\", handleKeyDown);\n  }, [active]);\n\n  return ref;\n}\n\nexport type CraftModalProps = {\n  open?: boolean;\n  defaultOpen?: boolean;\n  onOpenChange?: (open: boolean) => void;\n  tone?: ThemeName;\n  title?: React.ReactNode;\n  description?: React.ReactNode;\n  children?: React.ReactNode;\n  trigger?: React.ReactNode;\n  footer?: React.ReactNode;\n  className?: string;\n};\n\nexport function CraftModal({\n  open,\n  defaultOpen = false,\n  onOpenChange,\n  tone,\n  title,\n  description,\n  children,\n  trigger,\n  footer,\n  className,\n}: CraftModalProps) {\n  const [uncontrolledOpen, setUncontrolledOpen] = React.useState(defaultOpen);\n  const isControlled = typeof open === \"boolean\";\n  const isOpen = isControlled ? open : uncontrolledOpen;\n\n  const setOpen = React.useCallback(\n    (next: boolean) => {\n      if (!isControlled) {\n        setUncontrolledOpen(next);\n      }\n      onOpenChange?.(next);\n    },\n    [isControlled, onOpenChange]\n  );\n\n  React.useEffect(() => {\n    if (!isOpen) return;\n    const handleKey = (event: KeyboardEvent) => {\n      if (event.key === \"Escape\") setOpen(false);\n    };\n    document.addEventListener(\"keydown\", handleKey);\n    return () => document.removeEventListener(\"keydown\", handleKey);\n  }, [isOpen, setOpen]);\n\n  const ref = useFocusTrap(isOpen);\n\n  const content = isOpen ? (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center px-4 py-8\">\n      <div\n        className=\"absolute inset-0 backdrop-blur-sm\"\n        onClick={() => setOpen(false)}\n      />\n      <div\n        ref={ref}\n        tabIndex={-1}\n        className={cn(\n          \"relative z-10 w-full max-w-7xl rounded-3xl border border-[rgb(var(--nc-border)/0.45)] p-6 text-[rgb(var(--nc-fg))] shadow-[0_20px_60px_rgba(0,0,0,0.45)] backdrop-blur-2xl\",\n          \"max-h-[calc(100vh-1rem)] overflow-y-auto\",\n          className\n        )}\n        data-nc-theme={tone}\n      >\n        <div className=\"flex items-start justify-between gap-4\">\n          <div className=\"space-y-1\">\n            {title && <h3 className=\"text-2xl font-semibold\">{title}</h3>}\n            {description && <p className=\"text-[rgb(var(--nc-fg-muted))]\">{description}</p>}\n          </div>\n          <button\n            className=\"rounded-full border border-[rgb(var(--nc-border)/0.3)] bg-[rgb(var(--nc-surface)/0.12)] p-2 text-[rgb(var(--nc-fg-soft))] transition hover:text-[rgb(var(--nc-fg))]\"\n            onClick={() => setOpen(false)}\n            aria-label=\"Close\"\n          >\n            <svg viewBox=\"0 0 20 20\" className=\"h-4 w-4\" fill=\"currentColor\">\n              <path d=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\" />\n            </svg>\n          </button>\n        </div>\n        <div className=\"mt-5 space-y-4\">{children}</div>\n        {footer && <div className=\"mt-6\">{footer}</div>}\n      </div>\n    </div>\n  ) : null;\n\n  return (\n    <>\n      {trigger && (\n        <span\n          onClick={() => setOpen(true)}\n          onKeyDown={(event) => {\n            if (event.key === \"Enter\" || event.key === \" \") setOpen(true);\n          }}\n          role=\"button\"\n          tabIndex={0}\n          className=\"inline-flex\"\n        >\n          {trigger}\n        </span>\n      )}\n      {typeof document !== \"undefined\" && content\n        ? createPortal(content, document.body)\n        : content}\n    </>\n  );\n}\n"],"mappings":"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","names":[]}