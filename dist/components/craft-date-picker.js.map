{"version":3,"sources":["../../src/components/craft-date-picker.tsx"],"sourcesContent":["import * as React from \"react\";\n\nimport { cn } from \"@/utils/cn\";\nimport type { ThemeName } from \"@/theme/theme-context\";\n\nexport type CraftDatePickerProps = {\n  value?: string;\n  defaultValue?: string;\n  onChange?: (value: string) => void;\n  tone?: ThemeName;\n  min?: string;\n  max?: string;\n  placeholder?: string;\n  className?: string;\n};\n\nconst WEEK_DAYS = [\"Su\", \"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\"];\n\nfunction formatDate(date: Date) {\n  const year = date.getFullYear();\n  const month = `${date.getMonth() + 1}`.padStart(2, \"0\");\n  const day = `${date.getDate()}`.padStart(2, \"0\");\n  return `${year}-${month}-${day}`;\n}\n\nfunction parseDate(value?: string) {\n  if (!value) return null;\n  const [year, month, day] = value.split(\"-\").map(Number);\n  if (!year || !month || !day) return null;\n  return new Date(year, month - 1, day);\n}\n\nfunction isSameDay(a: Date, b: Date) {\n  return (\n    a.getFullYear() === b.getFullYear() &&\n    a.getMonth() === b.getMonth() &&\n    a.getDate() === b.getDate()\n  );\n}\n\nfunction isOutsideRange(date: Date, min?: string, max?: string) {\n  const minDate = parseDate(min);\n  const maxDate = parseDate(max);\n  if (minDate && date < minDate) return true;\n  if (maxDate && date > maxDate) return true;\n  return false;\n}\n\nexport function CraftDatePicker({\n  value,\n  defaultValue,\n  onChange,\n  tone,\n  min,\n  max,\n  placeholder = \"Select date\",\n  className,\n}: CraftDatePickerProps) {\n  const [open, setOpen] = React.useState(false);\n  const [uncontrolledValue, setUncontrolledValue] = React.useState(defaultValue ?? \"\");\n  const isControlled = value !== undefined;\n  const selectedValue = isControlled ? value ?? \"\" : uncontrolledValue;\n  const selectedDate = parseDate(selectedValue);\n\n  const initialMonth = selectedDate ?? new Date();\n  const [viewDate, setViewDate] = React.useState<Date>(initialMonth);\n\n  React.useEffect(() => {\n    if (selectedDate) setViewDate(selectedDate);\n  }, [selectedDate]);\n\n  const wrapperRef = React.useRef<HTMLDivElement | null>(null);\n\n  React.useEffect(() => {\n    if (!open) return;\n    const handleClick = (event: MouseEvent) => {\n      if (!wrapperRef.current?.contains(event.target as Node)) {\n        setOpen(false);\n      }\n    };\n    const handleKey = (event: KeyboardEvent) => {\n      if (event.key === \"Escape\") setOpen(false);\n    };\n    document.addEventListener(\"mousedown\", handleClick);\n    document.addEventListener(\"keydown\", handleKey);\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClick);\n      document.removeEventListener(\"keydown\", handleKey);\n    };\n  }, [open]);\n\n  const setValue = React.useCallback(\n    (next: string) => {\n      if (!isControlled) setUncontrolledValue(next);\n      onChange?.(next);\n    },\n    [isControlled, onChange]\n  );\n\n  const monthStart = new Date(viewDate.getFullYear(), viewDate.getMonth(), 1);\n  const monthEnd = new Date(viewDate.getFullYear(), viewDate.getMonth() + 1, 0);\n  const startDay = monthStart.getDay();\n  const daysInMonth = monthEnd.getDate();\n  const cells = Array.from({ length: startDay + daysInMonth }, (_, i) => {\n    const dayNumber = i - startDay + 1;\n    if (dayNumber < 1) return null;\n    return new Date(viewDate.getFullYear(), viewDate.getMonth(), dayNumber);\n  });\n\n  const handleDaySelect = (date: Date) => {\n    if (isOutsideRange(date, min, max)) return;\n    const next = formatDate(date);\n    setValue(next);\n    setOpen(false);\n  };\n\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLDivElement>) => {\n    if (!open) return;\n    if (!selectedDate) return;\n    const next = new Date(selectedDate);\n    if (event.key === \"ArrowRight\") next.setDate(next.getDate() + 1);\n    if (event.key === \"ArrowLeft\") next.setDate(next.getDate() - 1);\n    if (event.key === \"ArrowDown\") next.setDate(next.getDate() + 7);\n    if (event.key === \"ArrowUp\") next.setDate(next.getDate() - 7);\n    if (event.key === \"Enter\") {\n      event.preventDefault();\n      handleDaySelect(selectedDate);\n      return;\n    }\n    if (next.getTime() !== selectedDate.getTime()) {\n      event.preventDefault();\n      if (!isOutsideRange(next, min, max)) {\n        setValue(formatDate(next));\n        setViewDate(next);\n      }\n    }\n  };\n\n  return (\n    <div className=\"relative w-full\" data-nc-theme={tone} ref={wrapperRef}>\n      <button\n        type=\"button\"\n        onClick={() => setOpen((prev) => !prev)}\n        className={cn(\n          \"flex w-full items-center justify-between rounded-2xl border-2 bg-[rgb(var(--nc-surface)/0.08)] px-5 py-3 text-left text-base text-[rgb(var(--nc-fg))] backdrop-blur-xl\",\n          \"shadow-[inset_0_2px_8px_rgba(0,0,0,0.3)]\",\n          \"transition-all duration-300\",\n          \"border-[rgb(var(--nc-border)/0.35)]\",\n          \"focus:outline-none focus:ring-4 focus:ring-[rgb(var(--nc-accent-1)/0.3)]\",\n          className\n        )}\n      >\n        <span className={selectedValue ? \"text-[rgb(var(--nc-fg))]\" : \"text-[rgb(var(--nc-fg-soft))]\"}>\n          {selectedValue || placeholder}\n        </span>\n        <svg className=\"h-4 w-4 text-[rgb(var(--nc-fg-soft))]\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n          <path d=\"M6 2a1 1 0 011 1v1h6V3a1 1 0 112 0v1h1a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V6a2 2 0 012-2h1V3a1 1 0 011-1zm10 6H4v8h12V8z\" />\n        </svg>\n      </button>\n\n      {open && (\n        <div\n          className={cn(\n            \"absolute left-0 top-full z-20 mt-3 w-full rounded-3xl border border-[rgb(var(--nc-border)/0.3)] bg-[rgb(var(--nc-surface)/1.52)] p-4 text-[rgb(var(--nc-fg))] shadow-[0_20px_60px_rgba(0,0,0,0.55)] backdrop-blur-10xl\"\n          )}\n          onKeyDown={handleKeyDown}\n          tabIndex={-1}\n        >\n          <div className=\"flex items-center justify-between\">\n            <button\n              type=\"button\"\n              className=\"rounded-xl border border-[rgb(var(--nc-border)/0.3)] bg-[rgb(var(--nc-surface)/0.12)] px-3 py-1 text-sm text-[rgb(var(--nc-fg))]\"\n              onClick={() =>\n                setViewDate(\n                  new Date(viewDate.getFullYear(), viewDate.getMonth() - 1, 1)\n                )\n              }\n            >\n              Prev\n            </button>\n            <div className=\"text-sm font-semibold\">\n              {viewDate.toLocaleString(undefined, { month: \"long\", year: \"numeric\" })}\n            </div>\n            <button\n              type=\"button\"\n              className=\"rounded-xl border border-[rgb(var(--nc-border)/0.3)] bg-[rgb(var(--nc-surface)/0.12)] px-3 py-1 text-sm text-[rgb(var(--nc-fg))]\"\n              onClick={() =>\n                setViewDate(\n                  new Date(viewDate.getFullYear(), viewDate.getMonth() + 1, 1)\n                )\n              }\n            >\n              Next\n            </button>\n          </div>\n\n          <div className=\"mt-4 grid grid-cols-7 gap-2 text-xs text-[rgb(var(--nc-fg-muted))]\">\n            {WEEK_DAYS.map((day) => (\n              <div key={day} className=\"text-center\">\n                {day}\n              </div>\n            ))}\n          </div>\n\n          <div className=\"mt-2 grid grid-cols-7 gap-2\">\n            {cells.map((date, index) => {\n              if (!date) return <div key={`empty-${index}`} />;\n              const disabled = isOutsideRange(date, min, max);\n              const selected = selectedDate && isSameDay(date, selectedDate);\n              return (\n                <button\n                  key={date.toISOString()}\n                  type=\"button\"\n                  onClick={() => handleDaySelect(date)}\n                  disabled={disabled}\n                  className={cn(\n                    \"rounded-lg py-2 text-sm transition-all\",\n                    selected\n                      ? \"bg-[rgb(var(--nc-accent-1)/0.3)] text-[rgb(var(--nc-fg))]\"\n                      : \"text-[rgb(var(--nc-fg-muted))] hover:bg-[rgb(var(--nc-surface)/0.12)]\",\n                    disabled && \"opacity-40 hover:bg-transparent\"\n                  )}\n                >\n                  {date.getDate()}\n                </button>\n              );\n            })}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","names":[]}